import networkx as nx
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import heapq

# ================================
# 1. Створення графа 
# ================================

G = nx.Graph()

# Додаємо українські міста як вузли
cities = [
    "Київ", "Львів", "Одеса", "Харків", "Дніпро",
    "Запоріжжя", "Вінниця", "Івано-Франківськ", "Чернівці", "Полтава", "Миколаїв"
]

G.add_nodes_from(cities)

# Визначаємо логічні транспортні маршрути між містами
realistic_edges = [
    ("Київ", "Львів"), ("Київ", "Вінниця"), ("Київ", "Полтава"), ("Київ", "Дніпро"),
    ("Львів", "Івано-Франківськ"), ("Львів", "Чернівці"), ("Львів", "Вінниця"),
    ("Вінниця", "Чернівці"), ("Вінниця", "Одеса"), ("Одеса", "Миколаїв"), ("Одеса", "Дніпро"),
    ("Харків", "Полтава"), ("Харків", "Дніпро"), ("Дніпро", "Запоріжжя"), ("Дніпро", "Полтава"),
    ("Запоріжжя", "Харків"), ("Запоріжжя", "Дніпро"), ("Івано-Франківськ", "Чернівці"),
    ("Київ", "Харків"), ("Львів", "Дніпро"), ("Запоріжжя", "Одеса")  # Додані зв'язки
]

# Додаємо оновлений список зв'язків
G.add_edges_from(realistic_edges)

# Аналіз графа
num_nodes = G.number_of_nodes()
num_edges = G.number_of_edges()
degree_dict = dict(G.degree())
avg_degree = int(np.mean(list(degree_dict.values())))  # Округлення до цілого

# Створення таблиці для аналізу
df_realistic = pd.DataFrame(list(degree_dict.items()), columns=["Місто", "Ступінь"])
df_summary_realistic = pd.DataFrame({
    "Характеристика": ["Кількість міст", "Кількість зв'язків", "Середній ступінь"],
    "Значення": [num_nodes, num_edges, avg_degree]
})

# Виведення результатів у термінал ПЕРЕД візуалізацією графа
print("Ступінь міст:")
print(df_realistic.to_string(index=False))

print("\nОсновні характеристики транспортної мережі України:")
print(df_summary_realistic.to_string(index=False))

# Встановлюємо реальні координати міст
city_positions = {
    "Київ": (30.5234, 50.4501),
    "Львів": (24.0297, 49.8397),
    "Одеса": (30.7326, 46.4825),
    "Харків": (36.2304, 49.9935),
    "Дніпро": (35.0456, 48.4647),
    "Запоріжжя": (35.1396, 47.8388),
    "Вінниця": (28.4816, 49.2331),
    "Івано-Франківськ": (24.7111, 48.9226),
    "Чернівці": (25.9403, 48.2915),
    "Полтава": (34.5514, 49.5883),
    "Миколаїв": (31.9946, 46.9750)
}


plt.figure(figsize=(10, 7))

# Малюємо граф із географічно коректним розташуванням міст
nx.draw(G, city_positions, with_labels=True, node_color='lightblue', node_size=2000, edge_color='gray', font_size=10)
edge_labels = {(u, v): f"{d['weight']} км" for u, v, d in G.edges(data=True)}
nx.draw_networkx_edge_labels(G, city_positions, edge_labels=edge_labels, font_size=8)

plt.title("Граф транспортної мережі України (з вагами)")
plt.show()
